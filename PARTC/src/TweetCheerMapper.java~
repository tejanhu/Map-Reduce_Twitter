import java.io.IOException;
import java.util.StringTokenizer;
import org.apache.hadoop.io.IntWritable;
import org.apache.hadoop.io.Text;
import org.apache.hadoop.mapreduce.Mapper;
import org.apache.commons.lang.StringUtils;

public class TweetCheerMapper extends Mapper<Object, Text, Text, IntWritable> { 
	//constant variable stores a value of one
    private final IntWritable one = new IntWritable(1);
	//create a text variable
    Text data=new Text();
	//mapper method takes takes as input the text file
    public void map(Object key, Text value, Context context) throws IOException, InterruptedException {
  
    String dump = value.toString();
    if(StringUtils.ordinalIndexOf(dump,";",4)>-1){
        int startIndex = StringUtils.ordinalIndexOf(dump,";",3 + 1);
        String tweet = dump.substring(startIndex,dump.lastIndexOf(";"));
        //create a matrix which stores the countries from the method below
	String[][] tweetInformation = getCountryTweets();
		//iterate through the matrix and check whether the tweet within the dataset contains any key:cheer celebration and value:country in its contents
	for(int i=0;i<tweetInformation.length;i++){
      if(tweet.contains(tweetInformation[i][0])){
	//sets the contents within the array to lower case and stores that within the text variable which will be sent to the reducer
	data.set(tweetInformation[i][1].toLowerCase());
	//send country as a key and its occurrence as a value to the reducer
	context.write(data,one);
	}//END for loop
	}//END if statement
  

 	 }//END if statement
	

     

  }//END map method


	public static String[][] getCountryTweets(){
 	String tweetInfo[][]= {
	{"goAfghanistan", "Afghanistan"},
	{"teamAfghanistan", "Afghanistan"},
	{"goAlbania", "Albania"},{"teamAlbania", "Albania"},{"goAlgeria", "Algeria"},{"teamAlgeria", "Algeria"},{"goAmerican Samoa","American Samoa"},
	{"teamAmerican Samoa","American Samoa"},{"goAndorra", "Andorra"},{"teamAndorra","Andorra"}, {"goAngola","Angola"},{"teamAngola","Angola"},{"goAntigua and Barbuda","Antigua and Barbuda"},
	{"teamAntigua and Barbuda","Antigua and Barbuda"},{"goArgentina","Argentina"},
	{"teamArgentina","Argentina"}, {"goArmenia","Armenia"}, {"teamArmenia","Armenia"},{"goAruba","Aruba"},
	{"teamAruba","Aruba"},
	{"goAustralia","Australia"},
	{"teamAustralia","Australia"},
	{"goAustria","Austria"},
	{"teamAustria","Austria"},
	{"goAzerbaijan","Azerbaijan"},
	{"teamAzerbaijan","Azerbaijan"},
	{"goBahamas","Bahamas"},
	{"teamBahamas","Bahamas"},
	{"goBahrain","Bahrain"},
	{"teamBahrain","Bahrain"},
	{"goBangladesh","Bangladesh"},
	{"teamBangladesh","Bangladesh"},
	{"goBarbados","Barbados"},
	{"teamBarbados","Barbados"},
	{"goBelarus","Belarus"},
	{"teamBelarus","Belarus"},
	{"goBelgium","Belgium"},
	{"teamBelgium","Belgium"},
	{"goBelize","Belize"},
	{"teamBelize","Belize"},
	{"goBenin","Benin"},
	{"teamBenin","Benin"},
	{"goBermuda","Bermuda"},
	{"teamBermuda","Bermuda"},
	{"goBhutan","Bhutan"},
	{"teamBhutan","Bhutan"},
	{"goBolivia","Bolivia"},
	{"teamBolivia","Bolivia"},
	{"goBosnia and Herzegovina","Bosnia and Herzegovina"},
	{"teamBosnia and Herzegovina","Bosnia and Herzegovina"},
	{"goBotswana","Botswana"},
	{"teamBotswana","Botswana"},
	{"goBrazil","Brazil"},
	{"teamBrazil","Brazil"},
	{"goBritish Virgin Islands","British Virgin Islands"},
	{"teamBritish Virgin Islands","British Virgin Islands"},
	{"goBrunei","Brunei"},
	{"teamBrunei","Brunei"},
	{"goBulgaria","Bulgaria"},
	{"teamBulgaria","Bulgaria"},
	{"goBurkina Faso","Burkina Faso"},
	{"teamBurkina Faso","Burkina Faso"},
	{"goBurundi","Burundi"},
	{"teamBurundi","Burundi"},
	{"goCambodia","Cambodia"},
	{"teamCambodia","Cambodia"},
	{"goCameroon","Cameroon"},
	{"teamCameroon","Cameroon"},
	{"goCanada","Canada"},
	{"teamCanada","Canada"},
	{"goCape Verde","Cape Verde"},
	{"teamCape Verde","Cape Verde"},
	{"goCayman Islands","Cayman Islands"},
	{"teamCayman Islands","Cayman Islands"},
	{"goCentral African Republic","Central African Republic"},
	{"teamCentral African Republic","Central African Republic"},
	{"goChad","Chad"},
	{"teamChad","Chad"},
	{"goChile","Chile"},
	{"teamChile","Chile"},
	{"goChina","China"},
	{"teamChina","China"},
	{"goColombia","Colombia"},
	{"teamColombia","Colombia"},
	{"goComoro Islands","Comoro Islands"},
	{"teamComoro Islands","Comoro Islands"},
	{"goCongo","Congo"},
	{"teamCongo","Congo"},
	{"goDR Congo","DR Congo"},
	{"teamDR Congo","DR Congo"},
	{"goCook Islands","Cook Islands"},
	{"teamCook Islands","Cook Islands"},
	{"goCosta Rica","Costa Rica"},
	{"teamCosta Rica","Costa Rica"},
	{"goCroatia","Croatia"},
	{"teamCroatia","Croatia"},
	{"goCuba","Cuba"},
	{"teamCuba","Cuba"},
	{"goCyprus","Cyprus"},
	{"teamCyprus","Cyprus"},
	{"goCzech Republic","Czech Republic"},
	{"teamCzech Republic","Czech Republic"},
	{"goDenmark","Denmark"},
	{"teamDenmark","Denmark"},
	{"goDjibouti","Djibouti"},
	{"teamDjibouti","Djibouti"},
	{"goDominica","Dominica"},
	{"teamDominica","Dominica"},
	{"goDominican Republic","Dominican Republic"},
	{"teamDominican Republic","Dominican Republic"},
	{"goEcuador","Ecuador"},
	{"teamEcuador","Ecuador"},
	{"goEgypt","Egypt"},
	{"teamEgypt","Egypt"},
	{"goEl Salvador","El Salvador"},
	{"teamEl Salvador","El Salvador"},
	{"goEquatorial Guinea","Equatorial Guinea"},
	{"teamEquatorial Guinea","Equatorial Guinea"},
	{"goEritrea","Eritrea"},
	{"teamEritrea","Eritrea"},
	{"goEstonia","Estonia"},
	{"teamEstonia","Estonia"},
	{"goEthiopia","Ethiopia"},
	{"teamEthiopia","Ethiopia"},
	{"goFiji","Fiji"},
	{"teamFiji","Fiji"},
	{"goFinland","Finland"},
	{"teamFinland","Finland"},
	{"goFrance","France"},
	{"teamFrance","France"},
	{"goGabon","Gabon"},
	{"teamGabon","Gabon"},
	{"goGambia","Gambia"},
	{"teamGambia","Gambia"},
	{"goGeorgia","Georgia"},
	{"teamGeorgia","Georgia"},
	{"goGermany","Germany"},
	{"teamGermany","Germany"},
	{"goGhana","Ghana"},
	{"teamGhana","Ghana"},
	{"goGreat Britain","Great Britain"},
	{"teamGreat Britain","Great Britain"},
	{"goGreece","Greece"},
	{"teamGreece","Greece"},
	{"goGrenada","Grenada"},
	{"teamGrenada","Grenada"},
	{"goGuam","Guam"},
	{"teamGuam","Guam"},
	{"goGuatemala","Guatemala"},
	{"teamGuatemala","Guatemala"},
	{"goGuinea","Guinea"},
	{"teamGuinea","Guinea"},
	{"goGuinea-Bissau","Guinea-Bissau"},
	{"teamGuinea-Bissau","Guinea-Bissau"},
	{"goGuyana","Guyana"},
	{"teamGuyana","Guyana"},
	{"goHaiti","Haiti"},
	{"teamHaiti","Haiti"},
	{"goHonduras","Honduras"},
	{"teamHonduras","Honduras"},
	{"goHong Kong","Hong Kong"},
	{"teamHong Kong","Hong Kong"},
	{"goHungary","Hungary"},
	{"teamHungary","Hungary"},
	{"goIceland","Iceland"},
	{"teamIceland","Iceland"},
	{"goIndependent Olympic Athletes","Independent Olympic Athletes"},
	{"teamIndependent Olympic Athletes","Independent Olympic Athletes"},
	{"goIndia","India"},
	{"teamIndia","India"},
	{"goIndonesia","Indonesia"},
	{"teamIndonesia","Indonesia"},
	{"goIran","Iran"},
	{"teamIran","Iran"},
	{"goIraq","Iraq"},
	{"teamIraq","Iraq"},
	{"goIreland","Ireland"},
	{"teamIreland","Ireland"},
	{"goIsrael","Israel"},
	{"teamIsrael","Israel"},
	{"goItaly","Italy"},
	{"teamItaly","Italy"},
	{"goIvory Coast","Ivory Coast"},
	{"teamIvory Coast","Ivory Coast"},
	{"goJamaica","Jamaica"},
	{"teamJamaica","Jamaica"},
	{"goJapan","Japan"},
	{"teamJapan","Japan"},
	{"goJordan","Jordan"},
	{"teamJordan","Jordan"},
	{"goKazakhstan","Kazakhstan"},
	{"teamKazakhstan","Kazakhstan"},
	{"goKenya","Kenya"},
	{"teamKenya","Kenya"},
	{"goKiribati","Kiribati"},
	{"teamKiribati","Kiribati"},
	{"goNorth Korea","North Korea"},
	{"teamNorth Korea","North Korea"},
	{"goSouth Korea","South Korea"},
	{"teamSouth Korea","South Korea"},
	{"goKuwait","Kuwait"},
	{"teamKuwait","Kuwait"},
	{"goKyrgyzstan","Kyrgyzstan"},
	{"teamKyrgyzstan","Kyrgyzstan"},
	{"goLaos","Laos"},
	{"teamLaos","Laos"},
	{"goLatvia","Latvia"},
	{"teamLatvia","Latvia"},
	{"goLebanon","Lebanon"},
	{"teamLebanon","Lebanon"},
	{"goLesotho","Lesotho"},
	{"teamLesotho","Lesotho"},
	{"goLiberia","Liberia"},
	{"teamLiberia","Liberia"},
	{"goLibya","Libya"},
	{"teamLibya","Libya"},
	{"goLiechtenstein","Liechtenstein"},
	{"teamLiechtenstein","Liechtenstein"},
	{"goLithuania","Lithuania"},
	{"teamLithuania","Lithuania"},
	{"goLuxembourg","Luxembourg"},
	{"teamLuxembourg","Luxembourg"},
	{"goMacedonia","Macedonia"},
	{"teamMacedonia","Macedonia"},
	{"goMadagascar","Madagascar"},
	{"teamMadagascar","Madagascar"},
	{"goMalawi","Malawi"},
	{"teamMalawi","Malawi"},
	{"goMalaysia","Malaysia"},
	{"teamMalaysia","Malaysia"},
	{"goMaldives","Maldives"},
	{"teamMaldives","Maldives"},
	{"goMali","Mali"},
	{"teamMali","Mali"},
	{"goMalta","Malta"},
	{"teamMalta","Malta"},
	{"goMarshall Islands","Marshall Islands"},
	{"teamMarshall Islands","Marshall Islands"},
	{"goMauritania","Mauritania"},
	{"teamMauritania","Mauritania"},
	{"goMauritius","Mauritius"},
	{"teamMauritius","Mauritus"},
	{"goMexico","Mexico"},
	{"teamMexico","Mexico"},
	{"goFederated States of Micronesia","Federated States of Micronesia"},
	{"teamFederated States of Micronesia","Federated States of Micronesia"},
	{"goMoldova","Moldova"},
	{"teamMoldova","Moldova"},
	{"goMonaco","Monaco"},
	{"teamMonaco","Monaco"},
	{"goMongolia","Mongolia"},
	{"teamMongolia","Mongolia"},
	{"goMontenegro","Montenegro"},
	{"teamMontenegro","Montenegro"},
	{"goMorocco","Morocco"},
	{"teamMorocco","Morocco"},
	{"goMozambique","Mozambique"},
	{"teamMozambique","Mozambique"},
	{"goMyanmar","Myanmar"},
	{"teamMyanmar","Myanmar"},
	{"goNamibia","Namibia"},
	{"teamNamibia","Namibia"},
	{"goNauru","Nauru"},
	{"teamNauru","Nauru"},
	{"goNepal","Nepal"},
	{"teamNepal","Nepal"},
	{"goNetherlands","Netherlands"},
	{"teamNetherlands","Netherlands"},
	{"goNew Zealand","New Zealand"},
	{"teamNew Zealand","New Zealand"},
	{"goNicaragua","Nicaragua"},
	{"teamNicaragua","Nicaragua"},
	{"goNiger","Niger"},
	{"teamNiger","Niger"},
	{"goNigeria","Nigeria"},
	{"teamNigeria","Nigeria"},
	{"goNorway","Norway"},
	{"teamNorway","Norway"},
	{"goNorth Sudan","North Sudan"},
	{"teamNorth Sudan","North Sudan"},
	{"goOman","Oman"},
	{"teamOman","Oman"},
	{"goPakistan","Pakistan"},
	{"teamPakistan","Pakistan"},
	{"goPalau","Palau"},
	{"teamPalau","Palau"},
	{"goPalestine","Palestine"},
	{"teamPalestine","Palestine"},
	{"goPanama","Panama"},
	{"teamPanama","Panama"},
	{"goPapua New Guinea","Papua New Guinea"},
	{"teamPapua New Guinea","Papua New Guinea"},
	{"goParaguay","Paraguay"},
	{"teamParaguay","Paraguay"},
	{"goPeru","Peru"},
	{"teamPeru","Peru"},
	{"goPhilippines","Philippines"},
	{"teamPhilippines","Philippines"},
	{"goPoland","Poland"},
	{"teamPoland","Poland"},
	{"goPortugal","Portugal"},
	{"teamPortugal","Portugal"},
	{"goPuerto Rico","Puerto Rico"},
	{"teamPuerto Rico","Puerto Rico"},
	{"goQatar","Qatar"},
	{"teamQatar","Qatar"},
	{"goRomania","Romania"},
	{"teamRomania","Romania"},
	{"goRussia","Russia"},
	{"teamRussia","Russia"},
	{"goRwanda","Rwanda"},
	{"teamRwanda","Rwanda"},
	{"goSaint Kitts and Nevis","Saint Kitts and Nevis"},
	{"teamSaint Kitts and Nevis","Saint Kitts and Nevis"},
	{"goSaint Lucia","Saint Lucia"},
	{"teamSaint Lucia","Saint Lucia"},
	{"goSaint Vincent and the Grenadines","Saint Vincent and the Grenadines"},
	{"teamSaint Vincent and the Grenadines","Saint Vincent and the Grenadines"},
	{"goSamoa","Samoa"},
	{"teamSamoa","Samoa"},
	{"goSan Marino","San Marino"},
	{"teamSan Marino","San Marino"},
	{"goSão Tomé and Príncipe","São Tomé and Príncipe"},
	{"teamSão Tomé and Príncipe","São Tomé and Príncipe"},
	{"goSaudi Arabia","Saudi Arabia"},
	{"teamSaudi Arabia","Saudi Arabia"},
	{"goSenegal","Senegal"},
	{"teamSenegal","Senegal"},
	{"goSerbia","Serbia"},
	{"teamSerbia","Serbia"},
	{"goSeychelles","Seychelles"},
	{"teamSeychelles","Seychelles"},
	{"goSierra Leone","Sierra Leone"},
	{"teamSierra Leone","Sierra Leone"},
	{"goSingapore","Singapore"},
	{"teamSingapore","Singapore"},
	{"goSlovakia","Slovakia"},
	{"teamSlovakia","Slovakia"},
	{"goSlovenia","Slovenia"},
	{"teamSlovenia","Slovenia"},
	{"goSolomon Islands","Solomon Islands"},
	{"teamSolomon Islands","Solomon Islands"},
	{"goSomalia","Somalia"},
	{"teamSomalia","Somalia"},
	{"goSouth Africa","South Africa"},
	{"teamSouth Africa","South Africa"},
	{"goSpain","Spain"},
	{"teamSpain","Spain"},
	{"goSri Lanka","Sri Lanka"},
	{"teamSri Lanka","Sri Lanka"},
	{"goSouth Sudan","South Sudan"},
	{"teamSouth Sudan","South Sudan"},
	{"goSuriname","Suriname"},
	{"teamSuriname","Suriname"},
	{"goSwaziland","Swaziland"},
	{"teamSwaziland","Swaziland"},
	{"goSweden","Sweden"},
	{"teamSweden","Sweden"},
	{"goSwitzerland","Switzerland"},
	{"teamSwitzerland","Switzerland"},
	{"goSyria","Syria"},
	{"teamSyria","Syria"},
	{"goChinese Taipei","Chinese Taipei"},
	{"teamChinese Taipei","Chinese Taipei"},
	{"goTajikistan","Tajikistan"},
	{"teamTajikistan","Tajikistan"},
	{"goTanzania","Tanzania"},
	{"teamTanzania","Tanzania"},
	{"goThailand","Thailand"},
	{"teamThailand","Thailand"},
	{"goTimor-Leste","Timor-Leste"},
	{"teamTimor-Leste","Timor-Leste"},
	{"goTogo","Togo"},
	{"teamTogo","Togo"},
	{"goTonga","Tonga"},
	{"teamTonga","Tonga"},
	{"goTrinidad and Tobago","Trinidad and Tobago"},
	{"teamTrinidad and Tobago","Trinidad and Tobago"},
	{"goTunisia","Tunisia"},
	{"teamTunisia","Tunisia"},
	{"goTurkey","Turkey"},
	{"teamTurkey","Turkey"},
	{"goTurkmenistan","Turkmenistan"},
	{"teamTurkmenistan","Turkmenistan"},
	{"goTuvalu","Tuvalu"},
	{"teamTuvalu","Tuvalu"},
	{"goUganda","Uganda"},
	{"teamUganda","Uganda"},
	{"goUkraine","Ukraine"},
	{"teamUkraine","Ukraine"},
	{"goUnited Arab Emirates","United Arab Emirates"},
	{"teamUnited Arab Emirates","United Arab Emirates"},
	{"goUnited States","United States"},
	{"teamUnited States","United States"},
	{"goUruguay","Uruguay"},
	{"teamUruguay","Uruguay"},
	{"goUzbekistan","Uzbekistan"},
	{"teamUzbekistan","Uzbekistan"},
	{"goVanuatu","Vanuatu"},
	{"teamVanuatu","Vanuatu"},
	{"goVenezuela","Venezuela"},
	{"teamVenezuela","Venezuela"},
	{"goVietnam","Vietnam"},
	{"teamVietnam","Vietnam"},
	{"goVirgin Islands", "Virgin Islands"},
	{"teamVirgin Islands", "Virgin Islands"},
	{"goYemen", "Yemen"},
	{"teamYemen", "Yemen"},
	{"goZambia", "Zambia"},
	{"teamZambia", "Zambia"},
	{"goZimbabwe", "Zimbabwe"},
	{"teamZimbabwe", "Zimbabwe"}
	};
	
	

	return tweetInfo;
   
	}
	

}//END TweetCheerMapper
